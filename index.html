<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Picnic Quest: Don't Get Eaten!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- CORE SETTINGS --- */
        body {
            touch-action: none; /* Prevents scrolling/zooming on mobile */
            overflow: hidden;
            background-color: #ffdede;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            user-select: none;
            -webkit-user-select: none;
        }

        /* --- LAYERS --- */
        #bg-layer { position: fixed; inset: 0; z-index: 0; pointer-events: none; }
        #game-layer { position: fixed; inset: 0; z-index: 10; pointer-events: none; } /* Ants */
        #item-layer { position: fixed; inset: 0; z-index: 20; pointer-events: none; } /* Quest Items */
        #cursor-layer { position: fixed; inset: 0; z-index: 30; pointer-events: none; } /* Player Cookie */
        #ui-layer { position: fixed; inset: 0; z-index: 40; pointer-events: none; } /* HUD */
        #modal-layer { position: fixed; inset: 0; z-index: 50; display: flex; justify-content: center; align-items: center; }

        /* --- BACKGROUND PATTERN --- */
        .picnic-bg {
            background-image: 
                linear-gradient(45deg, #ffcccc 25%, transparent 25%, transparent 75%, #ffcccc 75%, #ffcccc),
                linear-gradient(45deg, #ffcccc 25%, transparent 25%, transparent 75%, #ffcccc 75%, #ffcccc);
            background-position: 0 0, 20px 20px;
            background-size: 40px 40px;
        }

        /* --- PLAYER CURSOR (COOKIE) --- */
        #player-cookie {
            position: absolute;
            width: 60px; /* Slightly larger for visibility on mobile */
            height: 60px;
            transform: translate(-50%, -50%); /* Centers cookie on finger */
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
            will-change: transform, top, left;
        }

        /* --- ANTS --- */
        .ant {
            position: absolute;
            width: 35px;
            height: 35px;
            transform: translate(-50%, -50%);
            will-change: transform, top, left;
        }
        .ant-svg {
            width: 100%;
            height: 100%;
            fill: #4a2c2a;
            filter: drop-shadow(1px 2px 2px rgba(0,0,0,0.2));
        }
        .ant.eating .ant-svg {
            animation: chomp 0.1s infinite alternate;
            fill: #8a1c1c;
        }
        @keyframes chomp { from { transform: scale(1); } to { transform: scale(1.15); } }

        /* --- QUEST ITEMS --- */
        .quest-item {
            position: absolute;
            width: 45px;
            height: 45px;
            font-size: 30px;
            background: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            border: 2px solid #fca5a5;
            animation: float 2s ease-in-out infinite;
            transform: translate(-50%, -50%);
            transition: transform 0.2s, opacity 0.2s;
        }
        .quest-item.collected {
            transform: translate(-50%, -50%) scale(1.5);
            opacity: 0;
        }
        @keyframes float { 0%, 100% { margin-top: 0; } 50% { margin-top: -8px; } }

        /* --- UI CARDS --- */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 4px solid #fecaca;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(164, 29, 29, 0.15);
            text-align: center;
            padding: 2rem;
            pointer-events: auto;
            max-width: 90%;
            width: 400px;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* --- HUD --- */
        .quest-hud {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 15px;
            border: 3px solid #fca5a5;
            font-weight: bold;
            color: #b91c1c;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            pointer-events: auto;
        }

        .timer-hud {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            border: 3px solid #fca5a5;
            font-weight: bold;
            color: #b91c1c;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        /* --- HEALTH BAR --- */
        #health-container {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 300px;
            height: 14px;
            background: rgba(255,255,255,0.6);
            border-radius: 20px;
            border: 2px solid rgba(0,0,0,0.1);
            overflow: hidden;
        }
        #health-fill {
            width: 100%;
            height: 100%;
            background: #22c55e;
            transition: width 0.1s linear, background-color 0.3s;
        }

        /* --- UTILITY --- */
        .hidden { display: none !important; }
        .btn {
            background: #f87171;
            color: white;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 1.1rem;
            margin-top: 1rem;
            box-shadow: 0 4px 0 #dc2626;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #dc2626;
        }
    </style>
</head>
<body class="picnic-bg">

    <!-- LAYERS -->
    <div id="bg-layer"></div>
    <div id="game-layer"></div> <!-- Ants spawn here -->
    <div id="item-layer"></div> <!-- Quest Items spawn here -->
    
    <div id="cursor-layer">
        <div id="player-cookie">
            <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#eab308" stroke="#92400e" stroke-width="3"/>
                <circle cx="50" cy="50" r="45" fill="url(#cookieGradient)" opacity="0.4"/>
                <defs>
                    <radialGradient id="cookieGradient">
                        <stop offset="0%" stop-color="#fff" />
                        <stop offset="100%" stop-color="#b45309" />
                    </radialGradient>
                </defs>
                <!-- Chips -->
                <circle cx="30" cy="30" r="6" fill="#3f2016" />
                <circle cx="70" cy="65" r="5" fill="#3f2016" />
                <circle cx="70" cy="30" r="6" fill="#3f2016" />
                <circle cx="30" cy="70" r="6" fill="#3f2016" />
                <circle cx="50" cy="50" r="5" fill="#3f2016" />
                <!-- Eyes -->
                <circle cx="35" cy="45" r="8" fill="white" stroke="#3f2016" stroke-width="1"/>
                <circle class="pupil" id="pupil-l" cx="35" cy="45" r="3" fill="black" />
                <circle cx="65" cy="45" r="8" fill="white" stroke="#3f2016" stroke-width="1"/>
                <circle class="pupil" id="pupil-r" cx="65" cy="45" r="3" fill="black" />
                <!-- Mouth -->
                <path d="M 40 65 Q 50 75 60 65" stroke="#3f2016" stroke-width="3" stroke-linecap="round" />
            </svg>
        </div>
    </div>

    <div id="ui-layer">
        <div class="quest-hud">
            üéØ Find: <span id="target-item" class="text-2xl">üçì</span>
            <div class="text-xs text-gray-500 mt-1">Score: <span id="score-display">0</span></div>
        </div>
        <div class="timer-hud">
            ‚è±Ô∏è <span id="timer-display">00:00</span>
        </div>
        <div id="health-container">
            <div id="health-fill"></div>
        </div>
    </div>

    <!-- MODALS -->
    <div id="modal-layer">
        
        <!-- START SCREEN -->
        <div id="start-screen" class="glass-card">
            <h1 class="text-4xl font-bold text-red-500 mb-2">Picnic Quest</h1>
            <p class="text-gray-600 text-lg mb-6">The ants want your cookie!</p>
            
            <div class="bg-red-50 rounded-xl p-4 text-left text-sm text-red-800 mb-6 space-y-2">
                <p>üëÜ <b>Drag</b> the cookie to move.</p>
                <p>üéØ <b>Collect</b> the items shown in the top left.</p>
                <p>üêú <b>Avoid</b> the ants! If they touch you, you shrink.</p>
            </div>

            <button class="btn" onclick="startGame()">Start Picnic</button>
        </div>

        <!-- GAME OVER SCREEN -->
        <div id="game-over-screen" class="glass-card hidden">
            <div class="text-6xl mb-2">üç™üêú</div>
            <h2 class="text-3xl font-bold text-red-600 mb-1">Picnic Ruined!</h2>
            <p class="text-gray-500 mb-4">You were completely eaten.</p>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-white p-3 rounded-lg border border-red-100">
                    <div class="text-xs text-gray-400 uppercase">Items Found</div>
                    <div class="text-2xl font-bold text-red-500" id="final-score">0</div>
                </div>
                <div class="bg-white p-3 rounded-lg border border-red-100">
                    <div class="text-xs text-gray-400 uppercase">Time</div>
                    <div class="text-2xl font-bold text-red-500" id="final-time">00:00</div>
                </div>
            </div>

            <p id="roast-text" class="text-sm italic text-orange-600 font-bold mb-6">"Better luck next time!"</p>

            <button class="btn" onclick="location.reload()">Play Again</button>
        </div>

    </div>

    <script>
        // --- CONFIG ---
        const ANT_COUNT = 12; // Slightly fewer for mobile performance
        const ANT_SPEED_BASE = 1.5;
        const SHRINK_RATE = 0.005;
        const ITEM_EMOJIS = ['üçì', 'ü•™', 'üßÉ', 'üßÄ', 'üçá', 'üçé', 'üç©'];
        
        // --- STATE ---
        let state = {
            playing: false,
            gameOver: false,
            w: window.innerWidth,
            h: window.innerHeight,
            touch: { x: window.innerWidth/2, y: window.innerHeight/2 },
            health: 1.0,
            score: 0,
            startTime: 0,
            targetItem: '',
            ants: [],
            activeItem: null
        };

        // --- DOM ELEMENTS ---
        const els = {
            cookie: document.getElementById('player-cookie'),
            gameLayer: document.getElementById('game-layer'),
            itemLayer: document.getElementById('item-layer'),
            startScreen: document.getElementById('start-screen'),
            gameOverScreen: document.getElementById('game-over-screen'),
            healthFill: document.getElementById('health-fill'),
            timer: document.getElementById('timer-display'),
            score: document.getElementById('score-display'),
            target: document.getElementById('target-item'),
            finalScore: document.getElementById('final-score'),
            finalTime: document.getElementById('final-time'),
            roast: document.getElementById('roast-text'),
            pupilL: document.getElementById('pupil-l'),
            pupilR: document.getElementById('pupil-r')
        };

        // --- SVG TEMPLATE ---
        const ANT_SVG = `
        <svg class="ant-svg" viewBox="0 0 100 100">
            <path d="M20 30 L5 20 M20 50 L5 50 M20 70 L5 80 M80 30 L95 20 M80 50 L95 50 M80 70 L95 80" stroke="currentColor" stroke-width="8" stroke-linecap="round" />
            <ellipse cx="50" cy="20" rx="15" ry="12" fill="currentColor" />
            <ellipse cx="50" cy="45" rx="12" ry="10" fill="currentColor" />
            <ellipse cx="50" cy="75" rx="20" ry="25" fill="currentColor" />
        </svg>`;

        // --- INITIALIZATION ---
        function startGame() {
            state.playing = true;
            state.startTime = Date.now();
            els.startScreen.classList.add('hidden');
            
            // Spawn initial ants
            for(let i=0; i<ANT_COUNT; i++) spawnAnt();
            
            // Start Quest
            nextQuest();
            
            // Start Loop
            loop();
        }

        function spawnAnt() {
            const div = document.createElement('div');
            div.className = 'ant';
            div.innerHTML = ANT_SVG;
            els.gameLayer.appendChild(div);

            // Spawn far away from center
            const angle = Math.random() * Math.PI * 2;
            const dist = Math.max(state.w, state.h) * 0.8;
            
            state.ants.push({
                el: div,
                x: (state.w/2) + Math.cos(angle) * dist,
                y: (state.h/2) + Math.sin(angle) * dist,
                speed: ANT_SPEED_BASE + Math.random(),
                angle: 0
            });
        }

        function nextQuest() {
            // Pick random item
            state.targetItem = ITEM_EMOJIS[Math.floor(Math.random() * ITEM_EMOJIS.length)];
            els.target.textContent = state.targetItem;

            // Spawn it
            const div = document.createElement('div');
            div.className = 'quest-item';
            div.textContent = state.targetItem;
            els.itemLayer.appendChild(div);

            // Random pos with padding
            const pad = 50;
            const tx = pad + Math.random() * (state.w - pad*2);
            const ty = pad + Math.random() * (state.h - pad*2);
            
            div.style.left = tx + 'px';
            div.style.top = ty + 'px';

            state.activeItem = {
                el: div,
                x: tx,
                y: ty
            };
        }

        // --- INPUT HANDLING ---
        function updateInput(x, y) {
            state.touch.x = x;
            state.touch.y = y;
            
            // Move Eyes
            const eyeX = Math.min(Math.max((x - state.w/2)/50, -3), 3);
            const eyeY = Math.min(Math.max((y - state.h/2)/50, -3), 3);
            els.pupilL.style.transform = `translate(${eyeX}px, ${eyeY}px)`;
            els.pupilR.style.transform = `translate(${eyeX}px, ${eyeY}px)`;
        }

        document.addEventListener('mousemove', e => {
            if(!state.playing) return;
            updateInput(e.clientX, e.clientY);
        });

        document.addEventListener('touchmove', e => {
            if(!state.playing) return;
            e.preventDefault(); // Prevent scroll
            updateInput(e.touches[0].clientX, e.touches[0].clientY);
        }, { passive: false });
        
        document.addEventListener('touchstart', e => {
             if(!state.playing) return;
             updateInput(e.touches[0].clientX, e.touches[0].clientY);
        });

        // --- GAME LOOP ---
        function loop() {
            if(!state.playing || state.gameOver) return;

            // Update Timer
            const elapsed = Math.floor((Date.now() - state.startTime) / 1000);
            const mins = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const secs = (elapsed % 60).toString().padStart(2, '0');
            els.timer.textContent = `${mins}:${secs}`;

            // Update Player Visual
            els.cookie.style.left = state.touch.x + 'px';
            els.cookie.style.top = state.touch.y + 'px';
            els.cookie.style.transform = `translate(-50%, -50%) scale(${state.health})`;

            let eaters = 0;

            // Update Ants
            state.ants.forEach(ant => {
                const dx = state.touch.x - ant.x;
                const dy = state.touch.y - ant.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                
                if(dist > 40) { // Chasing
                    ant.el.classList.remove('eating');
                    const vx = (dx/dist) * ant.speed;
                    const vy = (dy/dist) * ant.speed;
                    ant.x += vx;
                    ant.y += vy;
                    ant.angle = Math.atan2(dy, dx) * (180/Math.PI) + 90;
                } else { // Eating
                    eaters++;
                    ant.el.classList.add('eating');
                    // Jitter around center
                    ant.x = state.touch.x + (Math.random()-0.5) * 30 * state.health;
                    ant.y = state.touch.y + (Math.random()-0.5) * 30 * state.health;
                }

                ant.el.style.left = ant.x + 'px';
                ant.el.style.top = ant.y + 'px';
                ant.el.style.transform = `translate(-50%, -50%) rotate(${ant.angle}deg)`;
            });

            // Check Quest Item
            if(state.activeItem) {
                const ix = state.touch.x - state.activeItem.x;
                const iy = state.touch.y - state.activeItem.y;
                const idist = Math.sqrt(ix*ix + iy*iy);

                if(idist < 45) { // Collected!
                    state.score++;
                    els.score.textContent = state.score;
                    
                    // Heal slightly
                    state.health = Math.min(state.health + 0.15, 1.0);
                    
                    // Animate out
                    state.activeItem.el.classList.add('collected');
                    const oldEl = state.activeItem.el;
                    setTimeout(() => oldEl.remove(), 200);
                    
                    state.activeItem = null;
                    nextQuest();
                    
                    // Increase difficulty slightly
                    state.ants.forEach(a => a.speed += 0.05);
                }
            }

            // Handle Health
            if(eaters > 0) {
                state.health -= (SHRINK_RATE * eaters);
                
                // Color feedback
                if(state.health < 0.3) els.healthFill.style.backgroundColor = '#ef4444';
                else if(state.health < 0.6) els.healthFill.style.backgroundColor = '#eab308';
                else els.healthFill.style.backgroundColor = '#22c55e';

                if(state.health <= 0.05) triggerGameOver(elapsed);
            }
            els.healthFill.style.width = Math.max(0, state.health * 100) + '%';

            requestAnimationFrame(loop);
        }

        function triggerGameOver(finalTimeSecs) {
            state.gameOver = true;
            els.cookie.style.display = 'none';
            
            // Roasts
            const roasts = [
                "The ants are having a feast tonight!",
                "You made a delicious snack.",
                "Did you even try to run?",
                "Picnic cancelled due to... lack of cookie.",
                "That was a crumbling defeat."
            ];
            els.roast.textContent = `"${roasts[Math.floor(Math.random() * roasts.length)]}"`;
            
            els.finalScore.textContent = state.score;
            els.finalTime.textContent = els.timer.textContent;

            els.gameOverScreen.classList.remove('hidden');
        }

        // Resize handler
        window.addEventListener('resize', () => {
            state.w = window.innerWidth;
            state.h = window.innerHeight;
        });

    </script>
</body>
</html>
